<html>
  <head>
<title>prufa</title>
      
<meta charset="utf-8">
<link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
<script defer src="https://pyscript.net/latest/pyscript.js"></script>

<script>
  const slider = document.getElementById('maxtrains');
  const sliderValue = document.getElementById('slider-value');
  slider.addEventListener('input', () => {
    sliderValue.textContent = slider.value;
  });
</script>   
    
    </head>
       <body>

    <py-config>
      packages = ["matplotlib", "pandas"]
    </py-config>
<div>  
 <label for="city1">City 1:</label>
<input type= "text" list="cities" id="city1" name="city1" placeholder="Choose or type...">
<datalist id="cities">
  <option value="Atlanta">
  <option value="Boston">
  <option value="Calgary">
  <option value="Charleston">
  <option value="Chicago">
  <option value="Dallas">
  <option value="Denver">
  <option value="Duluth">
  <option value="El Paso">
  <option value="Helena">
  <option value="Houston">
  <option value="Kansas City">
  <option value="Las Vegas">
  <option value="Little Rock">
  <option value="Los Angeles">
  <option value="Miami">
  <option value="Montreal">
  <option value="Nashville">
  <option value="New Orleans">
  <option value="New York">
  <option value="Oklahoma City">
  <option value="Omaha">
  <option value="Phoenix">
  <option value="Pittsburgh">
  <option value="Portland">
  <option value="Raleigh">
  <option value="Saint Louis">
  <option value="Salt Lake City">
  <option value="San Francisco">
  <option value="Santa Fe">
  <option value="Seattle">
  <option value="Sault St. Marie">
  <option value="Toronto">
  <option value="Vancouver">
  <option value="Washington">
  <option value="Winnipeg">
</datalist>
        </div>  <div>  
 <label for="city">City 2:</label>
<input list="cities" id="city2" name="city2" placeholder="Choose or type...">
<datalist id="cities">
  <option value="Atlanta">
  <option value="Boston">
  <option value="Calgary">
  <option value="Charleston">
  <option value="Chicago">
  <option value="Dallas">
  <option value="Denver">
  <option value="Duluth">
  <option value="El Paso">
  <option value="Helena">
  <option value="Houston">
  <option value="Kansas City">
  <option value="Las Vegas">
  <option value="Little Rock">
  <option value="Los Angeles">
  <option value="Miami">
  <option value="Montreal">
  <option value="Nashville">
  <option value="New Orleans">
  <option value="New York">
  <option value="Oklahoma City">
  <option value="Omaha">
  <option value="Phoenix">
  <option value="Pittsburgh">
  <option value="Portland">
  <option value="Raleigh">
  <option value="Saint Louis">
  <option value="Salt Lake City">
  <option value="San Francisco">
  <option value="Santa Fe">
  <option value="Seattle">
  <option value="Sault St. Marie">
  <option value="Toronto">
  <option value="Vancouver">
  <option value="Washington">
  <option value="Winnipeg">
</datalist>
</div>  
        <div>    
 <label for="city">City 3:</label>
<input list="cities" id="city3" name="city3" placeholder="Choose or type...">
<datalist id="cities">
  <option value="Atlanta">
  <option value="Boston">
  <option value="Calgary">
  <option value="Charleston">
  <option value="Chicago">
  <option value="Dallas">
  <option value="Denver">
  <option value="Duluth">
  <option value="El Paso">
  <option value="Helena">
  <option value="Houston">
  <option value="Kansas City">
  <option value="Las Vegas">
  <option value="Little Rock">
  <option value="Los Angeles">
  <option value="Miami">
  <option value="Montreal">
  <option value="Nashville">
  <option value="New Orleans">
  <option value="New York">
  <option value="Oklahoma City">
  <option value="Omaha">
  <option value="Phoenix">
  <option value="Pittsburgh">
  <option value="Portland">
  <option value="Raleigh">
  <option value="Saint Louis">
  <option value="Salt Lake City">
  <option value="San Francisco">
  <option value="Santa Fe">
  <option value="Seattle">
  <option value="Sault St. Marie">
  <option value="Toronto">
  <option value="Vancouver">
  <option value="Washington">
  <option value="Winnipeg">
</datalist>
           
            </div>
           <div>  
           
          
 <label for="city">City 4:</label>
<input list="cities" id="city4" name="city4" placeholder="Choose or type...">
<datalist id="cities">
  <option value="Atlanta">
  <option value="Boston">
  <option value="Calgary">
  <option value="Charleston">
  <option value="Chicago">
  <option value="Dallas">
  <option value="Denver">
  <option value="Duluth">
  <option value="El Paso">
  <option value="Helena">
  <option value="Houston">
  <option value="Kansas City">
  <option value="Las Vegas">
  <option value="Little Rock">
  <option value="Los Angeles">
  <option value="Miami">
  <option value="Montreal">
  <option value="Nashville">
  <option value="New Orleans">
  <option value="New York">
  <option value="Oklahoma City">
  <option value="Omaha">
  <option value="Phoenix">
  <option value="Pittsburgh">
  <option value="Portland">
  <option value="Raleigh">
  <option value="Saint Louis">
  <option value="Salt Lake City">
  <option value="San Francisco">
  <option value="Santa Fe">
  <option value="Seattle">
  <option value="Sault St. Marie">
  <option value="Toronto">
  <option value="Vancouver">
  <option value="Washington">
  <option value="Winnipeg">
</datalist>
      </div>       
     <div>        
          
 <label for="city">City 5:</label>
<input list="cities" id="city5" name="city5" placeholder="Choose or type...">
<datalist id="cities">
  <option value="Atlanta">
  <option value="Boston">
  <option value="Calgary">
  <option value="Charleston">
  <option value="Chicago">
  <option value="Dallas">
  <option value="Denver">
  <option value="Duluth">
  <option value="El Paso">
  <option value="Helena">
  <option value="Houston">
  <option value="Kansas City">
  <option value="Las Vegas">
  <option value="Little Rock">
  <option value="Los Angeles">
  <option value="Miami">
  <option value="Montreal">
  <option value="Nashville">
  <option value="New Orleans">
  <option value="New York">
  <option value="Oklahoma City">
  <option value="Omaha">
  <option value="Phoenix">
  <option value="Pittsburgh">
  <option value="Portland">
  <option value="Raleigh">
  <option value="Saint Louis">
  <option value="Salt Lake City">
  <option value="San Francisco">
  <option value="Santa Fe">
  <option value="Seattle">
  <option value="Sault St. Marie">
  <option value="Toronto">
  <option value="Vancouver">
  <option value="Washington">
  <option value="Winnipeg">
</datalist>
   </div>          
           
  <div>
 <label for="city">City 6:</label>
<input list="cities" id="city6" name="city6" placeholder="Choose or type...">
<datalist id="cities">
  <option value="Atlanta">
  <option value="Boston">
  <option value="Calgary">
  <option value="Charleston">
  <option value="Chicago">
  <option value="Dallas">
  <option value="Denver">
  <option value="Duluth">
  <option value="El Paso">
  <option value="Helena">
  <option value="Houston">
  <option value="Kansas City">
  <option value="Las Vegas">
  <option value="Little Rock">
  <option value="Los Angeles">
  <option value="Miami">
  <option value="Montreal">
  <option value="Nashville">
  <option value="New Orleans">
  <option value="New York">
  <option value="Oklahoma City">
  <option value="Omaha">
  <option value="Phoenix">
  <option value="Pittsburgh">
  <option value="Portland">
  <option value="Raleigh">
  <option value="Saint Louis">
  <option value="Salt Lake City">
  <option value="San Francisco">
  <option value="Santa Fe">
  <option value="Seattle">
  <option value="Sault St. Marie">
  <option value="Toronto">
  <option value="Vancouver">
  <option value="Washington">
  <option value="Winnipeg">
</datalist>
 </div>         
                    
  <p>Maximum amount of trains to be used:</p>

  <input type="text" id="maxtrains" name="maxtrains"
         min="1" max="45" value="45">
  <label for="Trains">Max 45</label>
           
              <div>
               <p>
               </p> </div>
   <div>
           
<button id="click-btn" type="submit" py-click="my_function()">OK</button>
  <div id="test-output"></div>
           

     </div>
        
        
<py-script id="main">  
  

graph = {
    'Atlanta': {'Charleston': 2, 'Miami': 5, 'Nashville': 1, 'New Orleans': 4, 'Raleigh': 2},
    'Boston': {'Montreal': 2, 'New York': 2},
    'Calgary': {'Helena': 4, 'Seattle': 4, 'Vancouver': 3, 'Winnipeg': 6},
    'Charleston': {'Atlanta': 2, 'Miami': 4, 'Raleigh': 2},
    'Chicago': {'Duluth': 3, 'Omaha': 4, 'Pittsburgh': 3, 'Saint Louis': 2, 'Toronto': 4},
    'Dallas': {'El Paso': 4, 'Houston': 1, 'Little Rock': 2, 'Oklahoma City': 2},
    'Denver': {'Helena': 4, 'Kansas City': 4, 'Oklahoma City': 4, 'Phoenix': 5, 'Salt Lake City': 3, 'Santa Fe': 2},
    'Duluth': {'Chicago': 3, 'Helena': 6, 'Kansas City': 5, 'Omaha': 2, 'Sault St. Marie': 3, 'Toronto': 6, 'Winnipeg': 4},
    'El Paso': {'Dallas': 4, 'Houston': 6, 'Los Angeles': 6, 'Oklahoma City': 5, 'Phoenix': 3, 'Santa Fe': 2},
    'Helena': {'Calgary': 4, 'Denver': 4, 'Duluth': 6, 'Omaha': 5, 'Salt Lake City': 3, 'Seattle': 6, 'Winnipeg': 4},
    'Houston': {'Dallas': 1, 'El Paso': 6, 'New Orleans': 2},
    'Kansas City': {'Denver': 4, 'Duluth': 5, 'Omaha': 1, 'Oklahoma City': 2, 'Saint Louis': 2},
    'Las Vegas': {'Los Angeles': 2, 'Salt Lake City': 3},
    'Little Rock': {'Dallas': 2, 'Nashville': 3, 'New Orleans': 3, 'Oklahoma City': 2, 'Saint Louis': 2},
    'Los Angeles': {'El Paso': 6, 'Las Vegas': 2, 'Phoenix': 3, 'San Francisco': 3},
    'Miami': {'Atlanta': 5, 'Charleston': 4, 'New Orleans': 6},
    'Montreal': {'Boston': 2, 'New York': 3, 'Sault St. Marie': 5, 'Toronto': 3},
    'Nashville': {'Atlanta': 1, 'Little Rock': 3, 'Pittsburgh': 4, 'Raleigh': 3, 'Saint Louis': 2},
    'New Orleans': {'Atlanta': 4, 'Houston': 2, 'Little Rock': 3, 'Miami': 6},
    'New York': {'Boston': 2, 'Montreal': 3, 'Pittsburgh': 2, 'Washington': 2},
    'Oklahoma City': {'Dallas': 2, 'Denver': 4, 'El Paso': 5, 'Kansas City': 2, 'Little Rock': 2},
    'Omaha': {'Chicago': 4, 'Denver': 4, 'Duluth': 2, 'Helena': 5, 'Kansas City': 1},
    'Phoenix': {'Denver': 5, 'El Paso': 3, 'Los Angeles': 3, 'Santa Fe': 3},
    'Pittsburgh': {'Chicago': 3, 'Nashville': 4, 'New York': 2, 'Raleigh': 2, 'Saint Louis': 5, 'Toronto': 2, 'Washington': 2},
    'Portland': {'Salt Lake City': 6, 'San Francisco': 5, 'Seattle': 1},
    'Raleigh': {'Atlanta': 2, 'Charleston': 2, 'Nashville': 3, 'Pittsburgh': 2, 'Washington': 2},
    'Saint Louis': {'Chicago': 2, 'Kansas City': 2, 'Little Rock': 2, 'Nashville': 2, 'Pittsburgh': 5},
    'Salt Lake City': {'Denver': 3, 'Helena': 3, 'Las Vegas': 3, 'Portland': 6, 'San Francisco': 5},
    'San Francisco': {'Los Angeles': 3, 'Portland': 5, 'Salt Lake City': 5},
    'Santa Fe': {'Denver': 2, 'El Paso': 2, 'Phoenix': 3},
    'Seattle': {'Calgary': 4, 'Helena': 6, 'Portland': 1, 'Vancouver': 1},
    'Sault St. Marie': {'Duluth': 3, 'Montreal': 5, 'Toronto': 2, 'Winnipeg': 6},
    'Toronto': {'Chicago': 4, 'Duluth': 6, 'Montreal': 3, 'Pittsburgh': 2, 'Sault St. Marie': 2},
    'Vancouver': {'Calgary': 3, 'Seattle': 1},
    'Washington': {'New York': 2, 'Pittsburgh': 2, 'Raleigh': 2},
    'Winnipeg': {'Calgary': 6, 'Duluth': 4, 'Helena': 4, 'Sault St. Marie': 6}
}


def score_route(trains):
    if trains == 1:
        return 1
    elif trains == 2:
        return 2
    elif trains == 3:
        return 4
    elif trains == 4:
        return 7
    elif trains == 5:
        return 10
    elif trains == 6:
        return 15
    else:
        return 0


def depth_limited_search(graph, target_cities, max_trains, depth_limit):
    best_path, best_score, total_trains_used = None, float('-inf'), 0

    def dfs(current_city, visited, score, remaining_targets, trains_used, depth):
        nonlocal best_path, best_score, total_trains_used

        if depth == depth_limit:
            return

        for neighbor, route_trains in graph[current_city].items():
            if neighbor not in [city for city, _ in visited] and trains_used + route_trains <= max_trains:
                new_visited = visited + [(current_city, neighbor)]
                new_remaining_targets = remaining_targets - set([neighbor]) if neighbor in remaining_targets else remaining_targets
                route_score = score_route(route_trains)
                new_score = score + route_score

                if not new_remaining_targets:
                    if new_score > best_score:
                        best_path, best_score, total_trains_used = new_visited, new_score, trains_used + route_trains
                    return

                dfs(neighbor, new_visited, new_score, new_remaining_targets, trains_used + route_trains, depth + 1)

    for city in target_cities:
        remaining_targets = target_cities - set([city])
        dfs(city, [], 0, remaining_targets, 0, 0)
    return best_path, best_score, total_trains_used


def iterative_deepening_search(graph, target_cities, max_trains):
    target_cities = set(target_cities)  # Convert target_cities to a set
    depth_limit = 1
    max_depth_limit = 1000  # Set the maximum depth limit
    best_path, best_score, total_trains_used = None, float('-inf'), 0

    while best_path is None and depth_limit <= max_depth_limit:
        path, score, trains_used = depth_limited_search(graph, target_cities, max_trains, depth_limit)
        if score > best_score:
            best_path, best_score, total_trains_used = path, score, trains_used
        depth_limit += 1

    if best_path is None:
        return "There are not enough trains to go between these cities.", None, None
    else:
        return best_path, best_score, total_trains_used

def my_function():   
    target_cities =[Element('city1').value,Element('city2').value,Element('city3').value,Element('city4').value,Element('city5').value,Element('city6').value]

    target_cities = list(filter(None, target_cities))

    max_trains = int(Element("maxtrains").value)
    best_path, best_score, total_trains_used = iterative_deepening_search(graph, target_cities, max_trains)
    if len(target_cities)>1:
      display("Best path:",best_path,f'Score: {best_score}',f'Trains used: {total_trains_used}', target="test-output")
    else:
        display("You need to choose at least two cities",target="test-output")


</py-script>
     
</body>
</html>  
